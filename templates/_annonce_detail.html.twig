
<div class="row">
    <div class="col-md-8">
        <!-- Photos -->
        {% if annonce.photos|length > 0 %}
            <div id="carouselPhotos" class="carousel slide mb-4" data-bs-ride="carousel">
                <div class="carousel-inner">
                    {% for key, photo in annonce.photos %}
                        <div class="carousel-item {{ key == 0 ? 'active' : '' }}">
                            <img src="{{ photo.url }}" class="d-block w-100" style="height: 400px; object-fit: cover;">
                        </div>
                    {% endfor %}
                </div>
                {% if annonce.photos|length > 1 %}
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselPhotos" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselPhotos" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                    </button>
                {% endif %}
            </div>
        {% endif %}

        <!-- Description -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>Description</h5>
            </div>
            <div class="card-body">
                <listing class="desc">{{ annonce.description }}</listing>
            </div>
        </div>

        <!-- All Photos -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>Galerie</h5>
            </div>
            <div class="card-body">
                {% for key, photo in annonce.photos %}
                    <img src="{{ photo.url }}" style="width: 49.5%; padding: 5px">
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <!-- Informations principales -->
        <div class="card mb-4">
            <div class="card-header">
                <span class="text-muted">
                    {{ annonce.createdAt|date('d-m-Y') }}
                </span>

                <span class="badge {{ annonce.isSwiped?(annonce.isActive?'bg-success':'bg-danger'):'bg-warning' }}" style="right: 10px; position: absolute;">
                    <i class='fa-solid fa-{{ annonce.isSwiped?(annonce.isActive?'check':'xmark'):'hourglass' }}'></i>
                    {{ annonce.isSwiped?(annonce.isActive?'Validé':'Refusé'):'En attente' }}
                </span>

                <h4>{{ annonce.titre }}</h4>
            </div>
            <div class="card-body">
                <h3 class="text-primary">{{ annonce.prix|number_format(0, '.', ' ') }}€</h3>
                <p class="text-muted">{{ annonce.prixSurface??((annonce.prix/annonce.surface)|round) }}€/m²</p>

                <hr>

                <div class="row">
                    <div class="col-6">
                        <strong>Vendeur :</strong><br>
                        {{ annonce.annonceur }}
                    </div>
                    <div class="col-6">
                        <strong>Type :</strong><br>
                        {{ annonce.type }}
                    </div>
                </div>

                <hr>

                <div class="row">
                    <div class="col-6">
                        <strong>Surface :</strong><br>
                        {{ annonce.surface }}m²
                    </div>
                    <div class="col-6">
                        <strong>Année :</strong><br>
                        {{ annonce.dateConstruction|date('Y') }}
                    </div>
                </div>

                <hr>

                <div class="row">
                    <div class="col-6">
                        <strong>Chauffage :</strong><br>
                        {{ annonce.chauffageSource }}<br>
                        <small class="text-muted">{{ annonce.chauffageType|replace({'Chauffage ': ''}) }}</small>
                    </div>
                    <div class="col-6">
                        <strong>Étage :</strong><br>
                        {{ annonce.etage }}/{{ annonce.etageMax }}
                    </div>
                </div>

                <hr>

                <div class="row">
                    <div class="col-6">
                        <strong>DPE :</strong><br>
                        <span class="badge {{ (annonce.dpe in ['A', 'B', 'C']) ? 'bg-success' : (annonce.dpe in ['D', 'E']) ? 'bg-warning' : 'bg-danger' }}">
                                {{ annonce.dpe }}
                            </span>
                    </div>
                    <div class="col-6">
                        <strong>GES :</strong><br>
                        <span class="badge {{ (annonce.ges in ['A', 'B', 'C']) ? 'bg-success' : (annonce.ges in ['D', 'E']) ? 'bg-warning' : 'bg-danger' }}">
                                {{ annonce.ges }}
                            </span>
                    </div>
                </div>

                <hr>

                {% if annonce.isSwiped %}
                    <div>
                        <strong>Motifs :</strong><br>
                        {% for motif in annonce.swipedMotifs|split(', ') %}
                            <span class="badge bg-secondary">{{ annonce.allMotifsFlip[motif] }}</span>
                        {% endfor %}
                    </div>

                    <hr>
                {% endif %}

                <div>
                    <strong>Caractéristiques :</strong><br>
                    {{ include('_caracIcone.html.twig', {'caracteristiques': annonce.caracteristiques, 'showIcon': true, 'showAll': true}) }}
                </div>

                <hr>

                <div>
                    <strong>Adresse :</strong><br>
                    {{ annonce.adresse }}<br>
                    <a href="https://www.google.com/maps/search/{{ annonce.adresse|url_encode }}" target="_blank" class="btn btn-sm btn-outline-primary mt-2">
                        <i class="fas fa-map-marker-alt"></i> Voir sur Maps
                    </a>
                </div>

                <hr>

                <a href="{{ annonce.lien }}" target="_blank" class="btn btn-primary w-100">
                    <i class="fas fa-external-link-alt"></i> Voir l'annonce originale
                </a>
            </div>
        </div>

        <!-- Section Carte -->
        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-map"></i> Localisation</h5>
            </div>
            <div class="card-body">
                <iframe
                    width="100%"
                    height="300"
                    frameborder="0"
                    style="border:0"
                    src="https://maps.google.com/maps?q={{ annonce.adresse|url_encode }}&output=embed"
                    allowfullscreen>
                </iframe>
                <div class="mt-3">
                    <div class="row">
                        <div class="col-6">
                            <a href="https://www.google.com/maps/dir/{{ annonce.adresse|url_encode }}/62+rue+francis+de+pressense,+69100" target="_blank" class="btn btn-sm btn-outline-success w-100">
                                <i class="fas fa-home"></i> Vers Domicile
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="https://www.google.com/maps/dir/{{ annonce.adresse|url_encode }}/222+cours+Lafayette,+69003" target="_blank" class="btn btn-sm btn-outline-info w-100">
                                <i class="fas fa-briefcase"></i> Vers Boulot
                            </a>
                        </div>
                    </div>
                </div>
                <p class="mt-2 text-muted">
                    <i class="fas fa-info-circle"></i>
                    Localisation approximative basée sur l'adresse : {{ annonce.adresse }}
                </p>
            </div>
        </div>
    </div>
</div>
